<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>A message to Sonya</title>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <style>
    :root {
      --yes: #9333ea; 
      --noBg: #f3e8ff;
      --card: rgba(255, 255, 255, 0.95);
      --text: #2e1065;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; min-height: 100svh; display: grid; place-items: center;
      background: radial-gradient(circle at center, #2e1065 0%, #0f0720 100%);
      font-family: system-ui, -apple-system, sans-serif; overflow: hidden; padding: 16px;
    }

    /* START BUTTON OVERLAY */
    #startOverlay {
      position: fixed; inset: 0; background: #0f0720;
      display: flex; justify-content: center; align-items: center;
      z-index: 9999; transition: opacity 0.5s ease;
    }
    #startBtn {
      padding: 20px 40px; font-size: 22px; font-weight: 800;
      background: var(--yes); color: white; border: none;
      border-radius: 999px; cursor: pointer;
      box-shadow: 0 0 20px rgba(147, 51, 234, 0.5);
    }

    .card {
      width: min(720px, 92vw); padding: 30px 22px; background: var(--card);
      border-radius: 24px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.3);
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden;
      display: none; 
    }
    .collapsible-content {
      display: grid; grid-template-rows: 0fr; opacity: 0;
      transition: grid-template-rows 0.6s ease, opacity 0.6s ease;
    }
    .collapsible-content.open { grid-template-rows: 1fr; opacity: 1; margin-top: 10px; }
    .inner { overflow: hidden; }
    .art { width: min(260px, 80vw); margin: 0 auto 10px; display: block; border-radius: 12px; }
    h1 { font-size: clamp(26px, 4vw, 44px); margin: 12px 0 18px; color: var(--text); transition: opacity 0.4s ease; }
    .button-zone { position: relative; width: 100%; height: 160px; margin: 0 auto; touch-action: none; }
    button.choice {
      position: absolute; top: 50%; transform: translate(-50%, -50%);
      padding: 16px 32px; font-size: 18px; font-weight: 800; border-radius: 999px;
      border: none; cursor: pointer; user-select: none; transition: transform .12s ease;
    }
    #yesBtn { left: 30%; background: var(--yes); color: #fff; z-index: 10; }
    #noBtn { left: 70%; background: var(--noBg); color: var(--yes); z-index: 100; }
    .result { display: none; animation: pop .35s ease; }
    .result h2 { font-size: clamp(34px, 5vw, 50px); color: var(--yes); margin-bottom: 5px; }
    @keyframes pop { from { transform: scale(.96); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  </style>
</head>
<body>

  <div id="startOverlay">
    <button id="startBtn">Open Message ðŸ’œ</button>
  </div>

  <audio id="valentineMusic" preload="auto" loop>
    <source src="music.mp3" type="audio/mpeg">
  </audio>

  <main class="card" id="mainCard">
    <h1 id="heading"></h1>
    <div class="collapsible-content" id="stretchContent">
      <div class="inner">
        <img class="art" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExdWZoM2t6ODd4czc0dXZ5aTY4b3lwdW5yczdrYmx0OThtODhkaDMzNCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/Zl7u48zLVFgLpRwq6f/giphy.gif">
        <section class="button-zone" id="zone">
          <button id="yesBtn" class="choice">Yes</button>
          <button id="noBtn" class="choice">No</button>
        </section>

        <p id="cheekyText" style="color: #2e1065; font-weight: bold; margin-top: 20px; opacity: 0; transition: opacity 1s ease;">
          Is "No" even an option? ðŸ˜ˆ
        </p>
        
      </div>
    </div>

    <section class="result" id="result">
      <h2>Yay! I knew it! ðŸŽ‰</h2>
      <p style="color: var(--text); font-size: 18px; font-weight: 600; margin-bottom: 20px;">You're stuck with me now! ðŸ’œ</p>
      <img class="art" src="https://media.giphy.com/media/v1.Y2lkPWVjZjA1ZTQ3eHU0MndsYzZ1MGpqaXBoNHNmeGp6YWFvcjU2eGNseWF4NGdhY2t5OCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/lYjA4tfvCc8UAju1Op/giphy.gif">
    </section>
  </main>

  <script>
    const music = document.getElementById("valentineMusic");
    const startBtn = document.getElementById("startBtn");
    const startOverlay = document.getElementById("startOverlay");
    const mainCard = document.getElementById("mainCard");
    const heading = document.getElementById("heading");
    const stretchContent = document.getElementById("stretchContent");
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const zone = document.getElementById("zone");

    startBtn.addEventListener("click", () => {
      // PLAY THE MUSIC
      music.play().catch(e => console.log("Playback failed:", e));

      // HIDE OVERLAY
      startOverlay.style.opacity = "0";
      setTimeout(() => {
        startOverlay.style.display = "none";
        mainCard.style.display = "block";
        startSequence();
      }, 500);
    });

    function startSequence() {
      heading.innerText = "Hi Sonya,";
      setTimeout(() => {
        heading.style.opacity = 0;
        setTimeout(() => {
          heading.innerText = "Will you be my Valentine?";
          heading.style.opacity = 1;
          stretchContent.classList.add('open');

          // WAIT 4 SECONDS THEN SHOW PHRASE
          setTimeout(() => {
            cheekyText.style.opacity = "1";
          }, 3000);
          
        }, 500);
      }, 1500);
    }

    let yesScale = 1;
    function growYes() {
      yesScale = Math.min(2.5, yesScale + 0.12);
      yesBtn.style.transform = `translate(-50%, -50%) scale(${yesScale})`;
    }

    function moveNo(px, py) {
      const z = zone.getBoundingClientRect();
      const b = noBtn.getBoundingClientRect();
      let dx = (b.left + b.width / 2) - px;
      let dy = (b.top + b.height / 2) - py;
      let mag = Math.hypot(dx, dy) || 1;
      let newLeft = (b.left - z.left) + (dx / mag) * 150;
      let newTop  = (b.top - z.top) + (dy / mag) * 150;
      noBtn.style.left = Math.max(0, Math.min(z.width - b.width, newLeft)) + (b.width/2) + "px";
      noBtn.style.top = Math.max(0, Math.min(z.height - b.height, newTop)) + (b.height/2) + "px";
      noBtn.style.transform = "translate(-50%, -50%)";
      growYes();
    }

    zone.addEventListener("pointermove", e => {
      const b = noBtn.getBoundingClientRect();
      if (Math.hypot((b.left + b.width / 2) - e.clientX, (b.top + b.height / 2) - e.clientY) < 140) moveNo(e.clientX, e.clientY);
    });

    yesBtn.addEventListener("click", () => {
      heading.style.display = "none";
      stretchContent.style.display = "none";
      document.getElementById("result").style.display = "block";
      confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
    });
  </script>
</body>
</html>

